import{d as A,u as D,r as d,o as B,c as u,b as m,a as e,P as L,w as N,h as _,v as y,G as F,k as U,g as C,e as P,t as n,F as R,A as T,B as S,p as q,n as I,m as o,_ as z}from"./index-C3Rphj7m.js";const G={class:"user-management-container"},H={class:"user-management-content"},$={class:"create-user-section"},j={class:"form-row"},J={class:"form-group"},K=["disabled"],O={class:"form-group"},Q=["disabled"],W={class:"form-group"},X=["disabled"],Y={class:"form-actions"},Z=["disabled"],ee={class:"users-list-section"},se={key:0,class:"loading-state"},ae={key:1,class:"error-state"},te={key:2,class:"users-table-container"},re={class:"users-table"},le={class:"user-email"},oe={class:"user-info"},ne={class:"user-role"},ie={class:"user-created"},de={class:"user-last-sign-in"},ue={class:"user-status"},ce=A({__name:"UserManagementView",setup(me){const k=D(),{success:M,error:f}=I(),p=d(!1),l=d(!1),c=d(null),g=d([]),t=d({email:"",password:"",role:"user"}),E=d([{label:"Dashboard",href:"/"},{label:"Management",href:"/management"},{label:"User Management",href:"/management/users"}]),V=async()=>{l.value=!0;try{await k.createUser(t.value.email,t.value.password,t.value.role),M(`User ${t.value.email} created successfully!`,"Success"),t.value={email:"",password:"",role:"user"},await v()}catch(r){f(r.message||"Failed to create user","Error")}finally{l.value=!1}},v=async()=>{p.value=!0,c.value=null;try{const{data:r,error:s}=await q.auth.admin.listUsers();if(s)throw s;g.value=r.users||[]}catch(r){c.value=r.message||"Failed to load users",f(c.value||"An error occurred","Error")}finally{p.value=!1}},x=r=>{switch(r){case"superadmin":return"role-superadmin";case"admin":return"role-admin";default:return"role-user"}},b=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return B(()=>{v()}),(r,s)=>{const i=P("font-awesome-icon");return o(),u("div",G,[m(L,{title:"User Management",subtitle:"Manage system users and their roles",breadcrumbs:E.value},null,8,["breadcrumbs"]),e("div",H,[e("div",$,[s[7]||(s[7]=e("div",{class:"section-header"},[e("h3",null,"Create New User"),e("p",null,"Add a new user to the system")],-1)),e("form",{onSubmit:N(V,["prevent"]),class:"create-user-form"},[e("div",j,[e("div",J,[s[3]||(s[3]=e("label",{for:"email"},"Email Address",-1)),_(e("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=a=>t.value.email=a),type:"email",class:"form-input",placeholder:"Enter email address",required:"",disabled:l.value},null,8,K),[[y,t.value.email]])]),e("div",O,[s[4]||(s[4]=e("label",{for:"password"},"Password",-1)),_(e("input",{id:"password","onUpdate:modelValue":s[1]||(s[1]=a=>t.value.password=a),type:"password",class:"form-input",placeholder:"Enter password",required:"",disabled:l.value},null,8,Q),[[y,t.value.password]])]),e("div",W,[s[6]||(s[6]=e("label",{for:"role"},"Role",-1)),_(e("select",{id:"role","onUpdate:modelValue":s[2]||(s[2]=a=>t.value.role=a),class:"form-select",disabled:l.value},s[5]||(s[5]=[e("option",{value:"user"},"User",-1),e("option",{value:"admin"},"Admin",-1),e("option",{value:"superadmin"},"Super Admin",-1)]),8,X),[[F,t.value.role]])])]),e("div",Y,[e("button",{type:"submit",class:"btn btn-primary",disabled:l.value||!t.value.email||!t.value.password},[l.value?(o(),U(i,{key:0,icon:["fas","spinner"],class:"spinning"})):(o(),U(i,{key:1,icon:["fas","user-plus"]})),C(" "+n(l.value?"Creating...":"Create User"),1)],8,Z)])],32)]),e("div",ee,[s[11]||(s[11]=e("div",{class:"section-header"},[e("h3",null,"System Users"),e("p",null,"View and manage existing users")],-1)),p.value?(o(),u("div",se,[m(i,{icon:["fas","spinner"],class:"spinner"}),s[8]||(s[8]=e("p",null,"Loading users...",-1))])):c.value?(o(),u("div",ae,[m(i,{icon:["fas","exclamation-triangle"]}),e("p",null,n(c.value),1),e("button",{onClick:v,class:"btn btn-secondary"},[m(i,{icon:["fas","refresh"]}),s[9]||(s[9]=C(" Retry "))])])):(o(),u("div",te,[e("table",re,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",null,"Email"),e("th",null,"Role"),e("th",null,"Created"),e("th",null,"Last Sign In"),e("th",null,"Status")])],-1)),e("tbody",null,[(o(!0),u(R,null,T(g.value,a=>{var h,w;return o(),u("tr",{key:a.id,class:"user-row"},[e("td",le,[e("div",oe,[m(i,{icon:["fas","user"],class:"user-icon"}),e("span",null,n(a.email),1)])]),e("td",ne,[e("span",{class:S(["role-badge",x((h=a.user_metadata)==null?void 0:h.role)])},n(((w=a.user_metadata)==null?void 0:w.role)||"user"),3)]),e("td",ie,n(b(a.created_at)),1),e("td",de,n(a.last_sign_in_at?b(a.last_sign_in_at):"Never"),1),e("td",ue,[e("span",{class:S(["status-badge",a.email_confirmed_at?"confirmed":"pending"])},n(a.email_confirmed_at?"Confirmed":"Pending"),3)])])}),128))])])]))])])])}}}),ve=z(ce,[["__scopeId","data-v-f9b4dd1f"]]);export{ve as default};

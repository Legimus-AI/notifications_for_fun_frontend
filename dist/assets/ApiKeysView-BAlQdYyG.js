import{q as P,g as k,v as w,d as I,s as N,x as F,o as S,c,a as s,b as y,e as v,w as A,p as U,m as x,i as o,t as b,F as j,k as M,f,_ as D}from"./index-BhisPscf.js";import{v as z,e as _,z as B}from"./bootstrap-vue-3.es-BeRwdurs.js";const R=P("apiKeys",()=>{const V=k([]),l=k(!1),i=k(null),p=async()=>{var u,d;l.value=!0,i.value=null;try{const a=await w.getApiKeys();a.ok&&a.payload&&(V.value=Array.isArray(a.payload)?a.payload:[])}catch(a){i.value=((d=(u=a.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to fetch API keys"}finally{l.value=!1}};return{apiKeys:V,loading:l,error:i,fetchApiKeys:p,createApiKey:async u=>{var d,a;l.value=!0,i.value=null;try{(await w.createApiKey(u)).ok&&await p()}catch(r){throw i.value=((a=(d=r.response)==null?void 0:d.data)==null?void 0:a.message)||"Failed to create API key",r}finally{l.value=!1}},updateApiKey:async(u,d)=>{var a,r;l.value=!0,i.value=null;try{await w.updateApiKey(u,d),await p()}catch(m){i.value=((r=(a=m.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to update API key"}finally{l.value=!1}},toggleApiKey:async(u,d)=>{var a,r;l.value=!0,i.value=null;try{await w.toggleApiKey(u,d),await p()}catch(m){i.value=((r=(a=m.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to toggle API key"}finally{l.value=!1}},deleteApiKey:async u=>{var d,a;l.value=!0,i.value=null;try{await w.deleteApiKey(u),await p()}catch(r){i.value=((a=(d=r.response)==null?void 0:d.data)==null?void 0:a.message)||"Failed to delete API key"}finally{l.value=!1}}}}),$={class:"page-container"},q={class:"page-header"},L={class:"card"},T={class:"card-body"},E={class:"row"},O={class:"col-md-6 mb-3"},W={class:"row"},G={class:"col-12 mb-3"},H={class:"d-flex flex-wrap gap-3"},J={class:"d-flex justify-content-end"},Q=["disabled"],X={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Y={key:0,class:"text-danger mt-2 text-end"},Z={class:"row"},ee={class:"col-12"},se={class:"card"},te={key:0,class:"card-body text-center"},ae={key:1,class:"card-body text-center"},le={key:2,class:"list-group list-group-flush"},oe={class:"mb-0 fw-bold"},ne={class:"text-muted"},ie={class:"d-flex align-items-center gap-3"},de=["onClick"],re=I({__name:"ApiKeysView",setup(V){const l=R(),{apiKeys:i,loading:p,error:K}=N(l),g=k(!1),n=F({name:"",permissions:["channel:read"]}),h=()=>{l.fetchApiKeys()},u=async()=>{if(n.permissions.length===0){alert("Please select at least one permission.");return}await l.createApiKey(n),K.value||(Object.assign(n,{name:"",permissions:["channel:read"]}),g.value=!1)},d=async(m,e)=>{await l.toggleApiKey(m,e)},a=async m=>{confirm("Are you sure you want to delete this API key?")&&await l.deleteApiKey(m)},r=m=>new Date(m).toLocaleDateString();return S(h),(m,e)=>(f(),c("div",$,[s("header",q,[e[9]||(e[9]=s("div",null,[s("h1",{class:"page-title"},"API Keys"),s("p",{class:"page-description"}," Create and manage API keys for programmatic access. ")],-1)),s("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>g.value=!g.value)},e[8]||(e[8]=[s("i",{class:"bi bi-plus-lg me-2"},null,-1),v("Create API Key ")]))]),y(o(B),{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=t=>g.value=t),class:"mb-4"},{default:A(()=>[s("div",L,[s("div",T,[e[17]||(e[17]=s("h5",{class:"card-title mb-4"},"Create New API Key",-1)),s("form",{onSubmit:U(u,["prevent"])},[s("div",E,[s("div",O,[e[10]||(e[10]=s("label",{for:"apiKeyName",class:"form-label"},"API Key Name",-1)),y(o(z),{id:"apiKeyName",modelValue:n.name,"onUpdate:modelValue":e[1]||(e[1]=t=>n.name=t),type:"text",placeholder:"My API Key",required:""},null,8,["modelValue"])])]),s("div",W,[s("div",G,[e[16]||(e[16]=s("label",{class:"form-label"},"Permissions",-1)),s("div",H,[y(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[2]||(e[2]=t=>n.permissions=t),value:"channel:manage"},{default:A(()=>e[11]||(e[11]=[v("Channel Management")])),_:1,__:[11]},8,["modelValue"]),y(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[3]||(e[3]=t=>n.permissions=t),value:"notification:send"},{default:A(()=>e[12]||(e[12]=[v("Send Notifications")])),_:1,__:[12]},8,["modelValue"]),y(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[4]||(e[4]=t=>n.permissions=t),value:"webhook:manage"},{default:A(()=>e[13]||(e[13]=[v("Webhook Management")])),_:1,__:[13]},8,["modelValue"]),y(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[5]||(e[5]=t=>n.permissions=t),value:"notification:read"},{default:A(()=>e[14]||(e[14]=[v("Read Notifications")])),_:1,__:[14]},8,["modelValue"]),y(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[6]||(e[6]=t=>n.permissions=t),value:"channel:read"},{default:A(()=>e[15]||(e[15]=[v("Read Channels")])),_:1,__:[15]},8,["modelValue"])])])]),s("div",J,[s("button",{type:"submit",class:"btn btn-dark",disabled:o(p)},[o(p)?(f(),c("span",X)):x("",!0),v(" "+b(o(p)?"Creating...":"Create API Key"),1)],8,Q)]),o(K)?(f(),c("p",Y,b(o(K)),1)):x("",!0)],32)])])]),_:1},8,["modelValue"]),s("div",Z,[s("div",ee,[s("div",se,[e[21]||(e[21]=s("div",{class:"card-header d-flex justify-content-between align-items-center"},[s("h5",{class:"card-title mb-0"},"API Keys")],-1)),o(p)&&!o(i).length?(f(),c("div",te,e[18]||(e[18]=[s("div",{class:"spinner-border",role:"status"},null,-1)]))):o(i).length===0?(f(),c("div",ae,e[19]||(e[19]=[s("p",{class:"text-muted"},"No API keys created yet.",-1)]))):(f(),c("ul",le,[(f(!0),c(j,null,M(o(i),t=>(f(),c("li",{key:t._id,class:"list-group-item d-flex justify-content-between align-items-center px-4 py-3"},[s("div",null,[s("h6",oe,b(t.name),1),s("small",ne," Key: "+b(t.key.substring(0,20))+"... | Permissions: "+b(t.permissions.join(", "))+" | Created: "+b(r(t.createdAt)),1)]),s("div",ie,[y(o(_),{switch:"",checked:t.isActive,onChange:C=>d(t._id,!t.isActive)},null,8,["checked","onChange"]),s("button",{class:"btn btn-sm btn-outline-danger",onClick:C=>a(t._id)},e[20]||(e[20]=[s("i",{class:"bi bi-trash"},null,-1)]),8,de)])]))),128))]))])])])]))}}),me=D(re,[["__scopeId","data-v-c31373f7"]]);export{me as default};

import{D as C,r as k,E as w,d as I,s as N,I as F,o as S,c as y,b as c,a as s,q as v,g,P as U,w as M,f as h,i as o,t as b,F as j,A as D,m as f,_ as z}from"./index-CzTrTfDu.js";import{v as B,e as _,z as R}from"./bootstrap-vue-3.es-SbAnB5nQ.js";const $=C("apiKeys",()=>{const V=k([]),l=k(!1),i=k(null),m=async()=>{var u,d;l.value=!0,i.value=null;try{const a=await w.getApiKeys();a.ok&&a.payload&&(V.value=Array.isArray(a.payload)?a.payload:[])}catch(a){i.value=((d=(u=a.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to fetch API keys"}finally{l.value=!1}};return{apiKeys:V,loading:l,error:i,fetchApiKeys:m,createApiKey:async u=>{var d,a;l.value=!0,i.value=null;try{(await w.createApiKey(u)).ok&&await m()}catch(r){throw i.value=((a=(d=r.response)==null?void 0:d.data)==null?void 0:a.message)||"Failed to create API key",r}finally{l.value=!1}},updateApiKey:async(u,d)=>{var a,r;l.value=!0,i.value=null;try{await w.updateApiKey(u,d),await m()}catch(p){i.value=((r=(a=p.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to update API key"}finally{l.value=!1}},toggleApiKey:async(u,d)=>{var a,r;l.value=!0,i.value=null;try{await w.toggleApiKey(u,d),await m()}catch(p){i.value=((r=(a=p.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to toggle API key"}finally{l.value=!1}},deleteApiKey:async u=>{var d,a;l.value=!0,i.value=null;try{await w.deleteApiKey(u),await m()}catch(r){i.value=((a=(d=r.response)==null?void 0:d.data)==null?void 0:a.message)||"Failed to delete API key"}finally{l.value=!1}}}}),q={class:"page-container"},E={class:"card"},L={class:"card-body"},T={class:"row"},H={class:"col-md-6 mb-3"},O={class:"row"},W={class:"col-12 mb-3"},G={class:"d-flex flex-wrap gap-3"},J={class:"d-flex justify-content-end"},Q=["disabled"],X={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},Y={key:0,class:"text-danger mt-2 text-end"},Z={class:"row"},ee={class:"col-12"},se={class:"card"},te={key:0,class:"card-body text-center"},ae={key:1,class:"card-body text-center"},le={key:2,class:"list-group list-group-flush"},oe={class:"mb-0 fw-bold"},ne={class:"text-muted"},ie={class:"d-flex align-items-center gap-3"},de=["onClick"],re=I({__name:"ApiKeysView",setup(V){const l=$(),{apiKeys:i,loading:m,error:K}=N(l),A=k(!1),n=F({name:"",permissions:["channel:read"]}),P=()=>{l.fetchApiKeys()},u=async()=>{if(n.permissions.length===0){alert("Please select at least one permission.");return}await l.createApiKey(n),K.value||(Object.assign(n,{name:"",permissions:["channel:read"]}),A.value=!1)},d=async(p,e)=>{await l.toggleApiKey(p,e)},a=async p=>{confirm("Are you sure you want to delete this API key?")&&await l.deleteApiKey(p)},r=p=>new Date(p).toLocaleDateString();return S(P),(p,e)=>(f(),y("div",q,[c(U,{title:"API Keys",subtitle:"Create and manage API keys for programmatic access",icon:["fas","key"],breadcrumbs:[{label:"Management",icon:["fas","cog"],to:"/management"},{label:"API Keys",icon:["fas","key"]}]},{actions:v(()=>[s("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>A.value=!A.value)},e[8]||(e[8]=[s("i",{class:"bi bi-plus-lg me-2"},null,-1),g("Create API Key ")]))]),_:1}),c(o(R),{modelValue:A.value,"onUpdate:modelValue":e[7]||(e[7]=t=>A.value=t),class:"mb-4"},{default:v(()=>[s("div",E,[s("div",L,[e[16]||(e[16]=s("h5",{class:"card-title mb-4"},"Create New API Key",-1)),s("form",{onSubmit:M(u,["prevent"])},[s("div",T,[s("div",H,[e[9]||(e[9]=s("label",{for:"apiKeyName",class:"form-label"},"API Key Name",-1)),c(o(B),{id:"apiKeyName",modelValue:n.name,"onUpdate:modelValue":e[1]||(e[1]=t=>n.name=t),type:"text",placeholder:"My API Key",required:""},null,8,["modelValue"])])]),s("div",O,[s("div",W,[e[15]||(e[15]=s("label",{class:"form-label"},"Permissions",-1)),s("div",G,[c(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[2]||(e[2]=t=>n.permissions=t),value:"channel:manage"},{default:v(()=>e[10]||(e[10]=[g("Channel Management")])),_:1,__:[10]},8,["modelValue"]),c(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[3]||(e[3]=t=>n.permissions=t),value:"notification:send"},{default:v(()=>e[11]||(e[11]=[g("Send Notifications")])),_:1,__:[11]},8,["modelValue"]),c(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[4]||(e[4]=t=>n.permissions=t),value:"webhook:manage"},{default:v(()=>e[12]||(e[12]=[g("Webhook Management")])),_:1,__:[12]},8,["modelValue"]),c(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[5]||(e[5]=t=>n.permissions=t),value:"notification:read"},{default:v(()=>e[13]||(e[13]=[g("Read Notifications")])),_:1,__:[13]},8,["modelValue"]),c(o(_),{modelValue:n.permissions,"onUpdate:modelValue":e[6]||(e[6]=t=>n.permissions=t),value:"channel:read"},{default:v(()=>e[14]||(e[14]=[g("Read Channels")])),_:1,__:[14]},8,["modelValue"])])])]),s("div",J,[s("button",{type:"submit",class:"btn btn-dark",disabled:o(m)},[o(m)?(f(),y("span",X)):h("",!0),g(" "+b(o(m)?"Creating...":"Create API Key"),1)],8,Q)]),o(K)?(f(),y("p",Y,b(o(K)),1)):h("",!0)],32)])])]),_:1},8,["modelValue"]),s("div",Z,[s("div",ee,[s("div",se,[e[20]||(e[20]=s("div",{class:"card-header d-flex justify-content-between align-items-center"},[s("h5",{class:"card-title mb-0"},"API Keys")],-1)),o(m)&&!o(i).length?(f(),y("div",te,e[17]||(e[17]=[s("div",{class:"spinner-border",role:"status"},null,-1)]))):o(i).length===0?(f(),y("div",ae,e[18]||(e[18]=[s("p",{class:"text-muted"},"No API keys created yet.",-1)]))):(f(),y("ul",le,[(f(!0),y(j,null,D(o(i),t=>(f(),y("li",{key:t._id,class:"list-group-item d-flex justify-content-between align-items-center px-4 py-3"},[s("div",null,[s("h6",oe,b(t.name),1),s("small",ne," Key: "+b(t.key.substring(0,20))+"... | Permissions: "+b(t.permissions.join(", "))+" | Created: "+b(r(t.createdAt)),1)]),s("div",ie,[c(o(_),{switch:"",checked:t.isActive,onChange:x=>d(t._id,!t.isActive)},null,8,["checked","onChange"]),s("button",{class:"btn btn-sm btn-outline-danger",onClick:x=>a(t._id)},e[19]||(e[19]=[s("i",{class:"bi bi-trash"},null,-1)]),8,de)])]))),128))]))])])])]))}}),pe=z(re,[["__scopeId","data-v-5d0ed2a4"]]);export{pe as default};
